<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<style>
 body {font-family:tahoma,arial; margin:20px}
</style>
<script src="jquery-1.6.4.min.js"></script>
<script>
 var D,resume;
 function init(){
	resume=eval('('+localStorage["res"]+')');
	var mdp=localStorage["mdip"];
	$.ajax({type:"GET",url:mdp,dataType:"xml",success:parseMdp,error:function(xhr,st,er){finVisuChgt();alert("Error loading mdp file: "+er)}});
 }
 function xml2Sng(v){if(v==undefined)return 0;if(v.length==0||isNaN(v))return 0;num=v/1000;return Math.round(num*Math.pow(10,2))/Math.pow(10,2)}

 function basename(path){return path.replace(/\\/g,'/').replace( /.*\//, '' );}
 function dirname(path){return path.replace(/\\/g,'/').replace(/\/[^\/]*$/, '');}
 function parseMdp(xml,code,xhr){
	var s='';
	D=new Object();
	var xD=$(xml).find("Objets");
	D.nom=xD.attr("nom");
	D.unite='mm';
	if(xD.attr("unite")=='4')D.unite='in';
	xD.find("O").each(function(i){
		var O=new Object();
		O.x=$(this).attr('X'); if(O.x==undefined) O.x=xml2Sng($(this).attr('XX')); O.x=Number(O.x)+5;
		O.y=$(this).attr('Y'); if(O.y==undefined) O.y=xml2Sng($(this).attr('YY')); O.y=Number(O.y)+5;
		O.hauteur=$(this).attr('H'); if(O.hauteur==undefined) O.hauteur=xml2Sng($(this).attr('HH'));
		O.largeur=$(this).attr('L'); if(O.largeur==undefined) O.largeur=xml2Sng($(this).attr('LL'));
		O.nom=$(this).attr('nom');
		O.texte=$(this).attr('texte');
		O.gras=$(this).attr('fb')=='1';
		O.souligne=$(this).attr('fu')=='1';
		O.italique=$(this).attr('fi')=='1';
		O.fontsize=$(this).attr('fs');  if(O.fontsize==undefined) O.fontsize=xml2Sng($(this).attr('fss'));
		O.variable=$(this).attr('var');
		O.type=$(this).attr('type');
		O.align=$(this).attr('al');
		O.image=$(this).attr('ci');
		if(O.image!=undefined){
			if(O.image.lastIndexOf('/') >= 0) O.image=O.image.substring(O.image.lastIndexOf('/')+1);
			if(O.image.lastIndexOf('\\') >= 0) O.image=O.image.substring(O.image.lastIndexOf('\\')+1);
		}
		O.zoomimage=$(this).attr('zi'); if(O.zoomimage==undefined) O.zoomimage=xml2Sng($(this).attr('zii'));
		
		if(O.type==1){
			var path = dirname(localStorage["mdip"]) + '/'; if(path=='/')path='';
			s += '<img src="' + path + O.image + '" style="position:absolute;z-index:5;left:'+O.x+D.unite+';top:'+O.y+D.unite+';width:'+O.largeur+D.unite+';height:'+O.hauteur+D.unite+';padding-bottom:20'+D.unite+';padding-right:20'+D.unite+'" />';
		} else {
			var txt = O.texte;
			if (O.variable!=undefined) { txt=getVar(O.variable); if(txt==undefined) txt='';}
			s += '<div style="position:absolute;z-index:10;left:'+O.x+D.unite+';top:'+O.y+D.unite+';font-size:'+O.fontsize+'pt';
			if (O.gras) s += ';font-weight:bold';
			if (O.souligne) s += ';text-decoration:underline';
			if (O.italique) s += ';font-style:italic';
			s += '">' + txt + '</div>';
		}
	});
	document.getElementById('dip').innerHTML = s;
	document.getElementsByTagName('title')[0].innerHTML=resume.txtDip;
 }
 function getVar(v){
	try {
	 switch(v){
		case '21': return resume.dos;
		case '7': return resume.eng.club;
		case '5': return resume.lblCat;
		case '6': return resume.eng.ser;
		case '2': case '3': 
			var n=resume.eng.nom; if(n.indexOf(' ')>0)n=n.split(' ')[v=='2'?0:1]; return n;
		case '4': return resume.eng.nom;
		case '19': return resume.course;
		case '29': return resume.moy;
		case '28': return resume.distCourse;
		case '30': return resume.plCourse;
		case '31': return resume.plCat;
		case '22': return resume.sTemps;
		case '35': return resume.diplome;
		case '47': return resume.tours;
		case '48': return resume.parcouru;
		case '52': return resume.lblCat;

		//....
		case '23': return resume.sDepart;
		case '40': return resume.sTempsReel;
		case '38': return resume.nbEngCourse;
		// sx, nat, nom, prénom, année, licence, age
		// nom épreuve
	 }
	}catch(ex){}
	return '';
 }
</script>
</head>
<body onload="init()">
 <div id="dip"></div>
</body>
</html>
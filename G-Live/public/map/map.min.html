<html><head><meta charset="utf-8"><meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"><link rel="stylesheet" href="leaflet.css"><style>.elevation .axis,.leaflet-control-attribution,.leaflet-popup-close-button,.steelblue-theme.leaflet-control.elevation-collapsed .background{display:none}#map,body,html{margin:0;padding:0;width:100%;height:100%}.leaflet-control{clear:none}.leaflet-popup-content-wrapper{background:#2c3e50;color:#fff;line-height:24px;border-radius:0;font-size:12px}.leaflet-popup-content-wrapper a{color:rgba(255,255,255,.5)}.leaflet-popup-content{margin:6px}.leaflet-popup-tip-container{background:0 0;width:32px;height:15px}.leaflet-popup-tip{background:0 0;width:0;height:0;margin:0;transform:rotate(0);border-left:15px solid transparent;border-right:15px solid transparent;border-top:15px solid #2c3e50}.legende{padding:6px 8px;font:14px Arial,Helvetica,sans-serif;background:rgba(255,255,255,.9);box-shadow:0 1px 5px rgba(0,0,0,.65);border-radius:4px;cursor:default;line-height:18px}.legende i{width:18px;height:18px;float:left;margin-right:4px;opacity:.7}.legende span{float:left;margin-right:8px;white-space:nowrap;-webkit-transition:all .2s ease-in-out 0s;transition:all .2s ease-in-out 0s}.legende span:hover{color:#C92828}.elevation{margin:0!important}@media only screen and (max-width:600px){.legende{max-width:60%;padding:4px}}.steelblue-theme.leaflet-control.elevation .background{background-color:rgba(234,246,255,.85);border-radius:0}.steelblue-theme.leaflet-control.elevation .axis line,.steelblue-theme.leaflet-control.elevation .axis path{fill:none;stroke:#0d1821;stroke-width:2}.steelblue-theme.leaflet-control.elevation .mouse-drag{fill:rgba(23,74,117,.4)}.steelblue-theme.leaflet-control.elevation .elevation-toggle{cursor:pointer;box-shadow:0 1px 7px rgba(0,0,0,.4);-webkit-border-radius:5px;border-radius:5px;width:36px;height:36px;background-color:#f8f8f9}.steelblue-theme.leaflet-control.elevation .elevation-toggle-icon{background:url(images/elevation-steelblue.png) center center no-repeat}.steelblue-theme.leaflet-control.elevation .area{fill:#4682b4;stroke:#B6CED8}.steelblue-theme.leaflet-control.elevation .mouse-focus-line{pointer-events:none;stroke-width:1;stroke:#0d1821}.steelblue-theme.leaflet-control.elevation-collapsed .elevation-toggle{display:block}.steelblue-theme.height-focus{stroke:#fff;fill:#4682b4}.steelblue-theme.height-focus.line{pointer-events:none;stroke-width:2}</style><script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script><script src="leaflet.js"></script><script src="gpx.js"></script><script src="leaflet.textpath.js"></script><script src="leaflet.elevation-0.0.4.min.js"></script></head><body><div id="map"></div><script>function dirname(e){return e.replace(/\\/g,"/").replace(/\/[^\/]*$/,"")}function togglePcs(e){var r=Courses[e],o=!r.visible,t=r.layerGroup;o?(t.addTo(map),zi++,t.setZIndex(zi),map.fitBounds(r.layerTrack.getBounds(),{padding:[40,40]}),showTousPopups()):map.removeLayer(t),document.getElementById("chkp"+e).checked=o,r.visible=o,el.clear();var a=0;for(i=0;i<Courses.length;i++)Courses[i].visible&&a++;if(1==a)for(i=0;i<Courses.length;i++)Courses[i].visible&&void 0!=Courses[i].profil&&el.addData(Courses[i].profil)}function showTousPopups(){for(var e=0;e<Popups.length;e++)Popups[e].openPopup()}function majArriveeEtPointages(e){e.arrivee=void 0,e.depart=void 0,e.layerTrack.eachLayer(function(r){r.eachLayer(function(r){r.options&&r.options.icon&&(r.options.icon.options.iconUrl==iconeDpt&&(e.depart=r),r.options.icon.options.iconUrl==iconeArr&&(e.arrivee=r))})});var r=L.layerGroup([e.layerTrack]);for(e.layerGroup=r,e.visible=!0,e.marqueursPtges=[],j=0;j<Etape.Ptges.length;j++){var o=Etape.Ptges[j];if((P.ptgsurcourse(j,e.nom)||""==e.nom)&&!o.paspub){var t=o.lt,a=o.lg;if(void 0!=t&&""!=t&&void 0!=a&&""!=a){var i="<b>"+o.nom+"</b>",s="";if(void 0!=o.dist&&o.dist>""&&(s=o.dist),o.distP&&o.distP.length>e.ind&&o.distP[e.ind]>""&&(s=P.x2Sng(o.distP[e.ind])),s>""&&(i+=" "+P.mefDist(s)),p=!1,bResume&&void 0!=Resume.Ptges){var n=Resume.Ptges[j],p=n>"";if(p){var u=P.mefTpsBrut(Resume.PtgesBruts[j]),l=Resume.PlacesPtgs[j].scratch;u.indexOf(",")>0&&(u=u.substr(0,u.indexOf(",")-3)),i+="<br>"+P.txt(5)+" : "+l+"°, "+P.txt(6)+" : "+P.mefTps(0,n)+"<br>"+P.txt(25)+" : "+u}if(s>"");}var c=0;try{for(f=0;f<e.marqueursPtges.length;f++){var d=e.marqueursPtges[f];if(d._latlng.lat==t&&d._latlng.lng==a){var m=d.getPopup()._content;d.bindPopup(m+"<br>"+i),c=1}}}catch(e){}if(!c){var g=L.marker([t,a],{icon:p?iconePtOK:iconePt});r.addLayer(g);var h=g.bindPopup(i).openPopup();Popups.push(h),e.marqueursPtges.push(g)}}}}if(bResume&&Resume.arrive){var n=Resume.temps,u=P.mefTpsBrut(Resume.tpsBrut),l=Resume.plCourse;u.indexOf(",")>0&&(u=u.substr(0,u.indexOf(",")-3)),C.infoArrivee="<b>"+P.txt(17)+"</b><br>"+P.txt(5)+" : "+l+"°, "+P.txt(6)+" : "+P.mefTps(0,n)+"<br>"+P.txt(25)+" : "+u}if(e.arrivee){e.arrivee.options.clickable=!0,e.arrivee.options.icon.options.popupAnchor=[0,-35];var i=P.txt(17)+(" "+e.nom).trim();e.infoArrivee&&(i=e.infoArrivee);var h=e.arrivee.bindPopup(i).openPopup();Popups.push(h)}}function testArriveesDepartsCommuns(){var e,r,o,t=1;for(o=0;o<Courses.length;o++)C=Courses[o],void 0!=C.arrivee&&(0==o?(e=C.arrivee._latlng.lat,r=C.arrivee._latlng.lng):(Math.abs(e-C.arrivee._latlng.lat)>.001||Math.abs(r-C.arrivee._latlng.lng)>.001)&&(t=0));if(t)for(o=0;o<Courses.length;o++)C=Courses[o],void 0!=C.arrivee&&C.arrivee._popup.setContent(P.txt(17))}function loadGPX(e,r){return new L.GPX(e,{async:!0,marker_options:{startIconUrl:iconeDpt,endIconUrl:iconeArr,shadowUrl:"images/pin-shadow.png"},polyline_options:{color:r,opacity:.8}}).on("loaded",function(e){var r=e.target;bTousParcours&&void 0!=r.ind&&(document.getElementById("legende_"+r.ind).style.display=""),majArriveeEtPointages(r.course),r.course.layerGroup.addTo(map),map.fitBounds(r.getBounds(),{padding:[40,40]}),showTousPopups(),r.setText("           ❱           ",{repeat:!0,offset:8,attributes:{fill:"white",stroke:"black","stroke-width":"1px","font-size":"15pt","font-weight":"900",opacity:"0.7"}}),nbGPXCharges++,nbGPXCharges==Courses.length&&testArriveesDepartsCommuns()}).on("addline",function(e){bResume||1==Courses.length||""==e.target.course.nom?el.addData(e.line):e.target.course.profil=e.line})}var P=window.parent,course="",geoportail="www.genialp.com"==document.location.hostname,ignApiKey="0huj5ez6cytqjucviaiw0uh1",phone=0;try{window.matchMedia("(min-width:600px)").matches||(phone=1)}catch(e){}var cheminClax=P.URLEpr,E=P.E,Etape=P.Etape,Resume=P.resumeRech;void 0==Etape&&(Etape=P.Etapes[P.iEtape]);var bTousParcours="mapAll"==window.frameElement.id,bResume=!bTousParcours,nbGPXCharges=0;bResume&&(course=Resume.course),""==course&&(course="race"),document.title="";var di=dirname(cheminClax);di==cheminClax&&(di=""),L.Map=L.Map.extend({openPopup:function(e){return this._popup=e,this.addLayer(e).fire("popupopen",{popup:this._popup})}});var OSM=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> Contributors',maxZoom:18});if(geoportail)var scanExpressWmtsUrl="https://wxs.ign.fr/"+ignApiKey+"/wmts?LAYER=GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD&EXCEPTIONS=text/xml&FORMAT=image/jpeg&SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&STYLE=normal&TILEMATRIXSET=PM&&TILEMATRIX={z}&TILECOL={x}&TILEROW={y}",scanExpress2WmtsUrl="https://wxs.ign.fr/"+ignApiKey+"/wmts?LAYER=GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.CLASSIQUE&EXCEPTIONS=text/xml&FORMAT=image/jpeg&SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&STYLE=normal&TILEMATRIXSET=PM&&TILEMATRIX={z}&TILECOL={x}&TILEROW={y}",photosWmtsUrl="https://wxs.ign.fr/"+ignApiKey+"/wmts?LAYER=ORTHOIMAGERY.ORTHOPHOTOS&EXCEPTIONS=text/xml&FORMAT=image/jpeg&SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&STYLE=normal&TILEMATRIXSET=PM&&TILEMATRIX={z}&TILECOL={x}&TILEROW={y}",SCANEXPRESS=L.tileLayer(scanExpressWmtsUrl,{attribution:'&copy; <a href="http://www.ign.fr/">IGN</a>'}),SCANEXPRESS2=L.tileLayer(scanExpress2WmtsUrl,{attribution:'&copy; <a href="http://www.ign.fr/">IGN</a>'}),PHOTOS=L.tileLayer(photosWmtsUrl,{attribution:'&copy; <a href="http://www.ign.fr/">IGN</a>'});else var GOOGLESAT=L.tileLayer("https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]});var baseMap;baseMap=geoportail?{"Cartes IGN":SCANEXPRESS,"Cartes IGN (classique)":SCANEXPRESS2,"Photos a&eacute;riennes":PHOTOS,OpenStreetMap:OSM}:{"Google Earth":GOOGLESAT,OpenStreetMap:OSM};var carteDefaut=[OSM];geoportail&&(carteDefaut=[PHOTOS]);try{window.parent.defaultMap&&baseMap[window.parent.defaultMap]&&(carteDefaut=[],carteDefaut.push(baseMap[window.parent.defaultMap]))}catch(e){}var map=L.map("map",{layers:carteDefaut,closePopupOnClick:!1}).setView([44.907783722,6.05487864642],9);L.control.layers(baseMap).addTo(map);var Courses=[],Popups=[],couleurs=["orange","blue","red","black","green","pink","grey","orangered","lightblue","red","black","green","pink","grey"],C=new Object;for(C.nom=course,i=0;i<E.Courses.length;i++)E.Courses[i].nom==course&&(C.ind=i,C.couleur=E.Courses[i].cl);if(Courses.push(C),bTousParcours&&E.nbCourses>0)for(Courses=[],i=0;i<E.Courses.length;i++){var c=new Object;c.nom=E.Courses[i].nom,c.couleur=E.Courses[i].cl,c.ind=i,Courses.push(c)}var iconePt=L.icon({iconUrl:"images/pt.png",shadowUrl:"",iconSize:[16,16],shadowSize:[0,0],iconAnchor:[8,8],shadowAnchor:[0,0],popupAnchor:[0,-10]}),iconePtOK=L.icon({iconUrl:"images/pt_ok.png",shadowUrl:"",iconSize:[16,16],shadowSize:[0,0],iconAnchor:[8,8],shadowAnchor:[0,0],popupAnchor:[0,-10]}),iconeDpt="images/pin-icon-start.png",iconeArr="images/pin-icon-end.png",elevationLines=[];try{var el=L.control.elevation({position:"bottomright",theme:"steelblue-theme",width:document.getElementById("map").offsetWidth,height:80,margins:{top:16,right:10,bottom:16,left:10},hoverNumber:{decimalsX:2,decimalsY:0},xTicks:0,yTicks:0});el.addTo(map)}catch(e){}var dirgpx="../"+di+(""!=di?"/":"");for(i=0;i<Courses.length;i++){C=Courses[i];var gpx=dirgpx+C.nom+(E.nbEt>1?"-"+P.iEtape:"")+".gpx";void 0==C.couleur&&(C.couleur=couleurs[i]),layerTrack=loadGPX(gpx,C.couleur),C.layerTrack=layerTrack,layerTrack.course=C,layerTrack.ind=i}if(C=new Object,C.nom="",layerTrack=loadGPX(dirgpx+"race.gpx","blue"),layerTrack.course=C,C.layerTrack=layerTrack,layerTrack.course=C,bTousParcours&&Courses.length>0){var legende=L.control({position:"topright"});legende.onAdd=function(e){for(var r=L.DomUtil.create("div","legende"),o=0;o<Courses.length;o++)r.innerHTML+=' <span id="legende_'+o+'" style="display:none" onclick="togglePcs('+o+')"><i style="background:'+Courses[o].couleur+'"></i><input type="checkbox" id="chkp'+o+'" checked="checked" style="vertical-align:top">'+Courses[o].nom+"</span>";return r},legende.addTo(map)}var zi=1</script></body></html>